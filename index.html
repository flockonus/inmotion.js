<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>JavaScript In Motion</title>
		
		<script type="text/javascript" src="lib/jquery/jquery-1.4.2.js">   </script>
		<script type="text/javascript" src="lib/jquery/jquery.hotkeys.js"> </script> <!-- shall change to: http://www.openjs.com/scripts/events/keyboard_shortcuts/ -->
		
		<script type="text/javascript" src="lib/inmotion/editor.js"        ></script>
		<script type="text/javascript" src="lib/inmotion/super_bone.js"    ></script>
		<script type="text/javascript" src="lib/inmotion/drawing_table.js" ></script>
		<script type="text/javascript" src="lib/inmotion/key_frame.js"     ></script>
		
		<link type="text/css" rel="stylesheet" href="style/editor.css" />
		
		<script type="text/javascript">
			jQuery.noConflict();
			j = jQuery;
		</script>
		
		
		<script type="text/javascript">
			// point-zero baby ;)
			var $kfs = []
			var $dt = null
			//var $modes = { view : true, draw0 : true, draw1: true}
			var $mode = false
			var $focused_kf = null
			var $last_click = { x:0, y:0 }
			
			j(document).ready( function(){
				// TODO setar funcao de resize ao invez.
				resize()
				bind_keys()
				set_mode('draw0')
				
				$dt = new DrawingTable('drawingtable')
				$dt.reset()
				add_key_frame()
				j('#keyframes dd').live('click', function(e){
					_focus_key_frame( e.target )
				})
				
				j('#right').click( function(e){
					alert(e.target)
				})
			})
			
			// Aplico a Altura 
			function resize(){
				var h_header = jQuery('#header').css('height')
				var h_body = jQuery('body').css('height')
				
				var h_timeline = parseInt(h_body) - parseInt(h_header)
				jQuery('#timeline').css('height', h_timeline + 'px' )
			}
			
			function set_mode(state){
				switch(state){
					case 'draw0' : 
						set_stage_header('DRAW')
						break
					case 'view' :
						break;
					default: 
					alert( "MODO NAO IMPLEMENTADO: set_mode('"+state+"')" )
				}
				$mode = state
			}
			
			function set_stage_header( text ){
				j('#mode').html(text)
			}
			
			function bind_keys(){
				/*j(document).bind('keydown', 'd', function(){
					set_mode('draw')
				});
				*/
			}
			
			
			function add_key_frame(){
				kf = new KeyFrame()
				$kfs.push(kf)
				j('#keyframes').append('<dd>'+($kfs.length-1)+'.'+kf.preview()+'</dd>')
				scroll_down()
				_focus_key_frame( j('#keyframes').children(':eq('+($kfs.length-1)+')'  ) )
			}
			
			function _focus_key_frame(frame_node){
				j('.selected').removeClass('selected')
				j(frame_node).addClass('selected')
			}
			
			function scroll_down(){ }
			
			function scroll_up(){ }
			
		</script>
    </head>
    <body>
    	
		<div id="left">
			
    		<div id="header">
        		<h3>JavaScript In Motion</h3>
    		</div>
			
			<div id="timeline"> 
				<a href="javascript: add_key_frame();">[+]</a>
					<a href="javascript: scroll_up();">/\</a>
						<a href="javascript: scroll_down();">\/</a>
				<dl id="keyframes"> <!-- reflects the state of the var $kfs[] -->
				</dl>
			</div>
    	</div>
		
		
		<div id="right">
			<span id="mode"> STAGE </span><br/>
				<canvas id="drawingtable" width="300px" height="300px"> </canvas>
			
			<div id="console">
				CONSOLE
				
			</div>
		</div>
    </body>
</html>